<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
        <th scope="col" class="background--blue">
          {{
            this.appServ.loggedInUserInfo?.persona == "buyer"
              ? "Seller"
              : "Buyer"
          }}
        </th>
        <th></th>
        <th>Total Cost</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngIf="this.bids.length">
        <tr *ngFor="let bid of this.bids">
          <td class="text--left background--blue ">
            <ng-container
              *ngIf="this.appServ.loggedInUserInfo?.persona == 'seller'"
              class="text--left"
            >
              <p class="text--blue text--normal">{{ bid.buyer?.name }}</p>
              <p class="text--medium">{{ bid.buyer?.address }}</p>
              <p class="text--medium">{{ bid.buyer?.mobNo }}</p>
            </ng-container>
            <ng-container
              *ngIf="this.appServ.loggedInUserInfo?.persona == 'buyer'"
              class="text--left"
            >
              <p class="text--blue text--normal">{{ bid.seller?.name }}</p>
              <p class="text--medium">{{ bid.seller?.address }}</p>
              <p class="text--medium">{{ bid.seller?.mobNo }}</p>
            </ng-container>
            <p class="text--medium text--blue">Pickup:</p>
            <p class="text--medium">
              By <span class="text--bold">{{ bid.contactName }}</span>
            </p>
            <p class="text--medium">
              At
              <span class="text--bold">{{
                bid.pDateTime | date: "medium"
              }}</span>
            </p>
          </td>
          <td>
            <table class="bid-detail-table table table-sm table-borderless">
              <thead>
                <th scope="col">Material</th>
                <th scope="col">Bid Qty. (in kg)</th>
                <th scope="col">Bid Price (in ₹/kg)</th>
              </thead>
              <tbody>
                <ng-container
                  *ngFor="let material of this.materials | keyvalue"
                >
                  <tr *ngIf="bid.details[material.key]?.bidQuantity">
                    <td>{{ material.value }}</td>
                    <td>{{ bid.details[material.key]?.bidQuantity }}</td>
                    <td>{{ bid.details[material.key]?.bidCost }}</td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </td>
          <td>₹{{ bid.totalBid || 0 }}</td>
          <td>
            <div
              class="actions flex justify-end direction-column"
              *ngIf="bid.status == 'pending'"
            >
              <button
                mat-flat-button
                color="primary"
                class="rounded-button mb-2"
                *ngIf="
                  this.appServ.isUserLoggedIn &&
                  this.appServ.loggedInUserInfo?.persona == 'seller'
                "
                (click)="this.updateStatusOfBid(bid, 'accepted')"
              >
                Accept
              </button>
              <button
                mat-stroked-button
                color="primary"
                class="rounded-button mb-2"
                *ngIf="
                  this.appServ.isUserLoggedIn &&
                  this.appServ.loggedInUserInfo?.persona == 'seller'
                "
                (click)="this.updateStatusOfBid(bid, 'denied')"
              >
                Deny
              </button>
              <button
                mat-flat-button
                color="primary"
                class="rounded-button mb-2"
                *ngIf="
                  this.appServ.isUserLoggedIn &&
                  this.appServ.loggedInUserInfo?.persona == 'buyer'
                "
                [routerLink]="[
                  '/buyer',
                  this.appServ.loggedInUserInfo.id,
                  'bid'
                ]"
                [queryParams]="{ bidId: bid.id, sellerId: bid.sellerId }"
              >
                Edit
              </button>
              <button
                mat-stroked-button
                color="primary"
                class="rounded-button mb-2"
                *ngIf="
                  this.appServ.isUserLoggedIn &&
                  this.appServ.loggedInUserInfo?.persona == 'buyer'
                "
                (click)="this.updateStatusOfBid(bid, 'cancelled')"
              >
                Cancel
              </button>
            </div>
            <div class="actions flex" *ngIf="bid.status != 'pending'">
              <span class="tag actions flex" [ngClass]="'tag--' + bid.status">
                {{ bid.status }}
              </span>
            </div>
          </td>
        </tr>
      </ng-container>
      <tr *ngIf="!this.bids.length">
        <td colspan="5">
          <div class="flex mt-4">
            <p class="text--large text--blue">
              No Bids Here.
            </p>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="bid-list-container">
  <p class="text--largesecondary text--blue">
    Current Bids
  </p>
  <p class="text--normal text--gray">
    Bids not accepted before 18hrs of pick-up time will be automatically
    cancelled.
  </p>
  <div class="bid-list-table-container mt-4">
    <wm-bid-list-table [bids]="this.bids"></wm-bid-list-table>
  </div>
</div>

<wm-page-actions [user]="this.buyer">
  <div class="seller-details-template">
    <ng-container *ngTemplateOutlet="sellerDetailsTemplate"></ng-container>
  </div>
</wm-page-actions>

<ng-template #sellerDetailsTemplate>
  <table *ngIf="sellerItem" class="table mt-2">
    <tbody>
      <tr *ngFor="let material of this.materials | keyvalue">
        <td>{{ material.value }}</td>
        <td>
          <span>
            <ng-container
              [ngTemplateOutlet]="
                isSellerDataEditable ? editableItemQty : showableItemQty
              "
              [ngTemplateOutletContext]="{
                sellerItem: sellerItem,
                material: material
              }"
            ></ng-container>
            kg
          </span>
          <span>
            (â‚¹<ng-container
              [ngTemplateOutlet]="
                isSellerDataEditable ? editableItemCost : showableItemCost
              "
              [ngTemplateOutletContext]="{
                sellerItem: sellerItem,
                material: material
              }"
            ></ng-container
            >.00 / kg)
          </span>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="actions flex justify-end">
    <button
      mat-flat-button
      color="primary"
      class="rounded-button"
      (click)="
        this.isSellerDataEditable
          ? this.updateSellerItem()
          : (this.isSellerDataEditable = true)
      "
    >
      {{ isSellerDataEditable ? "Update data" : "Edit" }}
    </button>
  </div>
</ng-template>

<ng-template
  #showableItemQty
  let-sellerItem="sellerItem"
  let-material="material"
>
  {{ sellerItem.details[material.key].quantity }}
</ng-template>

<ng-template
  #editableItemQty
  let-sellerItem="sellerItem"
  let-material="material"
>
  <input
    type="number"
    class="form-control"
    [(ngModel)]="sellerItem.details[material.key].quantity"
  />
</ng-template>

<ng-template
  #showableItemCost
  let-sellerItem="sellerItem"
  let-material="material"
>
  {{ sellerItem.details[material.key].cost }}
</ng-template>

<ng-template
  #editableItemCost
  let-sellerItem="sellerItem"
  let-material="material"
>
  <input
    type="number"
    class="form-control"
    [(ngModel)]="sellerItem.details[material.key].cost"
  />
</ng-template>
